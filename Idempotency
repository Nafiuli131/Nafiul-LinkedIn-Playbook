ЁЯФБ Why Idempotency Matters in APIs

ржПржХржЯрж╛ рж╢рзБржХрзНрж░ржмрж╛рж░ ржмрж┐ржХрзЗрж▓ тАФ ржЖржкржирж┐ ржПржХржЯрж╛ food delivery app ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржЫрзЗржи ЁЯНФ
Payment ржХрж░рж▓рзЗржи, ржХрж┐ржирзНрждрзБ network рж╣ржарж╛рзО slow! ржЖржкржирж┐ ржнрж╛ржмрж▓рзЗржи тАФ тАЬрж╣ржпрж╝рждрзЛ рж╣ржпрж╝ржирж┐тАЭ, рждрж╛ржЗ ржЖржмрж╛рж░ Pay Now ржХрзНрж▓рж┐ржХ ржХрж░рж▓рзЗржиредржлрж▓рж╛ржлрж▓-ЁЯТ╕ Balance ржХрзЗржЯрзЗ ржЧрзЗрж▓ ржжрзБржЗржмрж╛рж░!

ржПржЗ ржЬрж╛ржпрж╝ржЧрж╛рждрзЗржЗ ржЖрж╕рзЗ Idempotency тАФ
API design-ржПрж░ ржПржоржи ржПржХржЯрж╛ concept, ржпрзЗржЯрж╛ ржмрж▓рзЗ:тАЬржПржХржЗ request ржмрж╛рж░ржмрж╛рж░ ржПрж▓рзЗржУ, system-ржПрж░ outcome ржПржХржЯрж╛ржЗ рж╣ржмрзЗредтАЭ
ржЕрж░рзНржерж╛рзО тАФ ржПржХржЯрж╛ operation repeat рж╣рж▓рзЗржУ result ржкрж░рж┐ржмрж░рзНрждржи рж╣ржмрзЗ ржирж╛ тЬЕ

ЁЯзй Real Example:
ржзрж░рзБржи backend ржП ржПржоржи ржПржХржЯрж╛ endpoint ржЖржЫрзЗ тАФ POST /api/orders
ржпрзЗржЯрж╛ ржПржХржЯрж╛ order create ржХрж░рзЗред ржПржЦржи ржпржжрж┐ user accidentally ржжрзБржЗржмрж╛рж░ click ржХрж░рзЗ, рждрж╛рж╣рж▓рзЗ ржжрзБржЯрзЛ order рж╣ржпрж╝рзЗ ржпрж╛ржмрзЗ ЁЯШ░

ржХрж┐ржирзНрждрзБ ржпржжрж┐ ржЖржорж░рж╛ idempotency key ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж┐ (ржпрзЗржоржи unique UUID ржмрж╛ transaction ID), рждрж╛рж╣рж▓рзЗ backend ржмрзБржЭржмрзЗ тАФтАЬржПржЗ request рждрзЛ ржЖржЧрзЗржУ ржПрж╕рзЗржЫрж┐рж▓!рждрж╛рж╣рж▓рзЗ ржЖржмрж╛рж░ order рждрзИрж░рж┐ ржХрж░рж╛рж░ ржжрж░ржХрж╛рж░ ржирзЗржЗредтАЭ
Result тАФ duplicate transaction ржЖрж░ рж╣ржмрзЗ ржирж╛!

тЪЩя╕П ржХрж┐ржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ:
1я╕ПтГг Client request ржкрж╛ржарж╛ржпрж╝ Idempotency-Key рж╕рж╣
2я╕ПтГг Server рж╕рзЗржЗ key check ржХрж░рзЗ
3я╕ПтГг ржпржжрж┐ key ржЖржЧрзЗ ржжрзЗржЦрж╛ ржерж╛ржХрзЗ тЖТ cached result ржлрзЗрж░ржд ржжрзЗржпрж╝
4я╕ПтГг ржирж╛ рж╣рж▓рзЗ тЖТ request process ржХрж░рзЗ ржЖрж░ result save ржХрж░рзЗ

ЁЯТб Simple Rule:
GET тЖТ by nature idempotent
DELETE тЖТ ideally idempotent
POST тЖТ not idempotent, unless ржЖржкржирж┐ consciously ржмрж╛ржирж╛ржи

ЁЯза Lesson:
Idempotency ржорж╛ржирзЗ рж╢рзБржзрзБ safe API ржирж╛ тАФ ржПржЯрж╛ рж╣рж▓рзЛ user trust ржПрж░ symbol ЁЯдЭ
ржХрж╛рж░ржг ржПржХржЬржи user ржпржжрж┐ ржжрзЗржЦрзЗ тАЬржжрзБржЗржмрж╛рж░ click ржХрж░рзЗржУ duplicate рж╣ржпрж╝ ржирж╛тАЭ, рждрж╛рж╣рж▓рзЗ рждрж╛рж░ ржмрж┐рж╢рзНржмрж╛рж╕ ржмрж╛ржбрж╝рзЗ system-ржПрж░ ржУржкрж░ред
